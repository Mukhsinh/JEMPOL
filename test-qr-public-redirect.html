<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test QR Code Public Redirect</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5; }
        .card { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        h1 { color: #1e40af; }
        h2 { color: #374151; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px; }
        .success { color: #059669; background: #d1fae5; padding: 10px; border-radius: 4px; }
        .error { color: #dc2626; background: #fee2e2; padding: 10px; border-radius: 4px; }
        .info { color: #2563eb; background: #dbeafe; padding: 10px; border-radius: 4px; }
        button { background: #3b82f6; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #2563eb; }
        button.secondary { background: #6b7280; }
        button.secondary:hover { background: #4b5563; }
        .link-list { display: flex; flex-direction: column; gap: 10px; }
        .link-item { display: flex; align-items: center; gap: 10px; padding: 15px; background: #f9fafb; border-radius: 8px; border: 1px solid #e5e7eb; }
        .link-item:hover { background: #f3f4f6; border-color: #3b82f6; }
        .link-icon { font-size: 24px; }
        .link-info { flex: 1; }
        .link-title { font-weight: bold; color: #1f2937; }
        .link-desc { font-size: 12px; color: #6b7280; }
        a { color: #3b82f6; text-decoration: none; }
        a:hover { text-decoration: underline; }
        pre { background: #1f2937; color: #f9fafb; padding: 15px; border-radius: 4px; overflow-x: auto; font-size: 12px; }
        .test-section { margin-top: 20px; }
    </style>
</head>
<body>
    <h1>ğŸ”— Test QR Code Public Redirect</h1>
    
    <div class="card">
        <h2>ğŸ“‹ Ringkasan Perbaikan</h2>
        <div class="info">
            <p><strong>Masalah:</strong> QR code mengarahkan ke aplikasi dengan login, bukan langsung ke form.</p>
            <p><strong>Solusi:</strong> QR code sekarang mengarahkan langsung ke halaman public tanpa perlu login:</p>
            <ul>
                <li><code>/public/tiket-internal</code> - Form tiket internal (untuk staff)</li>
                <li><code>/public/tiket-eksternal</code> - Form tiket eksternal (untuk publik)</li>
                <li><code>/public/survei</code> - Form survei kepuasan</li>
            </ul>
        </div>
    </div>

    <div class="card">
        <h2>ğŸ§ª Test Halaman Public (Tanpa Login)</h2>
        <div class="link-list">
            <div class="link-item">
                <div class="link-icon">ğŸ“</div>
                <div class="link-info">
                    <div class="link-title">Form Tiket Internal</div>
                    <div class="link-desc">Khusus untuk petugas internal rumah sakit</div>
                </div>
                <a href="/public/tiket-internal?qr=TEST001&unit_id=test-unit&unit_name=Unit%20Test&auto_fill=true" target="_blank">
                    <button>Buka Form</button>
                </a>
            </div>
            
            <div class="link-item">
                <div class="link-icon">ğŸ“‹</div>
                <div class="link-info">
                    <div class="link-title">Form Tiket Eksternal</div>
                    <div class="link-desc">Untuk pengaduan, saran, atau permintaan informasi publik</div>
                </div>
                <a href="/public/tiket-eksternal?qr=TEST001&unit_id=test-unit&unit_name=Unit%20Test&auto_fill=true" target="_blank">
                    <button>Buka Form</button>
                </a>
            </div>
            
            <div class="link-item">
                <div class="link-icon">â­</div>
                <div class="link-info">
                    <div class="link-title">Form Survei Kepuasan</div>
                    <div class="link-desc">Berikan penilaian terhadap layanan yang diterima</div>
                </div>
                <a href="/public/survei?qr=TEST001&unit_id=test-unit&unit_name=Unit%20Test&auto_fill=true" target="_blank">
                    <button>Buka Form</button>
                </a>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>ğŸ” Test QR Code Landing Page</h2>
        <p>Halaman landing QR code yang menampilkan pilihan atau auto-redirect:</p>
        <div class="link-list">
            <div class="link-item">
                <div class="link-icon">ğŸ“±</div>
                <div class="link-info">
                    <div class="link-title">QR Scan Landing (Baru)</div>
                    <div class="link-desc">Halaman landing setelah scan QR code - /scan/:code</div>
                </div>
                <a href="/scan/TEST001" target="_blank">
                    <button>Test Scan</button>
                </a>
            </div>
            
            <div class="link-item">
                <div class="link-icon">ğŸ“±</div>
                <div class="link-info">
                    <div class="link-title">QR Landing (Legacy)</div>
                    <div class="link-desc">Halaman landing lama - /qr/:code</div>
                </div>
                <a href="/qr/TEST001" target="_blank">
                    <button class="secondary">Test Legacy</button>
                </a>
            </div>
        </div>
    </div>

    <div class="card">
        <h2>âš™ï¸ Konfigurasi QR Code</h2>
        <p>Saat membuat QR code di halaman manajemen, admin dapat memilih:</p>
        <ul>
            <li><strong>Tampilkan Pilihan (selection)</strong> - Pelanggan memilih jenis layanan</li>
            <li><strong>Form Tiket Internal (internal_ticket)</strong> - Langsung ke form tiket internal</li>
            <li><strong>Form Tiket Eksternal (external_ticket)</strong> - Langsung ke form tiket eksternal</li>
            <li><strong>Form Survei (survey)</strong> - Langsung ke form survei kepuasan</li>
        </ul>
        <p>Opsi <strong>Auto-fill Unit</strong> akan mengisi otomatis unit berdasarkan QR code yang di-scan.</p>
    </div>

    <div class="card">
        <h2>ğŸ“Š Alur QR Code</h2>
        <pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ALUR QR CODE SCAN                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. Pelanggan scan QR Code                                      â”‚
â”‚     â†“                                                           â”‚
â”‚  2. Redirect ke /scan/{code}                                    â”‚
â”‚     â†“                                                           â”‚
â”‚  3. Cek redirect_type dari QR Code:                             â”‚
â”‚     â”‚                                                           â”‚
â”‚     â”œâ”€â†’ selection: Tampilkan pilihan layanan                    â”‚
â”‚     â”‚   â””â”€â†’ Pelanggan pilih â†’ Redirect ke form                  â”‚
â”‚     â”‚                                                           â”‚
â”‚     â”œâ”€â†’ internal_ticket: Auto redirect ke /public/tiket-internalâ”‚
â”‚     â”‚                                                           â”‚
â”‚     â”œâ”€â†’ external_ticket: Auto redirect ke /public/tiket-eksternalâ”‚
â”‚     â”‚                                                           â”‚
â”‚     â””â”€â†’ survey: Auto redirect ke /public/survei                 â”‚
â”‚                                                                 â”‚
â”‚  4. Form terisi otomatis dengan info unit dari QR Code          â”‚
â”‚     â†“                                                           â”‚
â”‚  5. Pelanggan isi form dan submit                               â”‚
â”‚     â†“                                                           â”‚
â”‚  6. Tiket/Survei tersimpan dengan nomor tracking                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        </pre>
    </div>

    <div class="card">
        <h2>âœ… Checklist Verifikasi</h2>
        <div class="test-section">
            <p>Pastikan semua halaman dapat diakses tanpa login:</p>
            <ul>
                <li>[ ] <code>/public/tiket-internal</code> - Form tiket internal terbuka</li>
                <li>[ ] <code>/public/tiket-eksternal</code> - Form tiket eksternal terbuka</li>
                <li>[ ] <code>/public/survei</code> - Form survei terbuka</li>
                <li>[ ] <code>/scan/:code</code> - Landing page QR scan berfungsi</li>
                <li>[ ] Unit terisi otomatis dari parameter URL</li>
                <li>[ ] Submit form berhasil tanpa login</li>
            </ul>
        </div>
    </div>

    <script>
        console.log('Test QR Code Public Redirect loaded');
        console.log('Halaman public yang tersedia:');
        console.log('- /public/tiket-internal');
        console.log('- /public/tiket-eksternal');
        console.log('- /public/survei');
        console.log('- /scan/:code');
    </script>
</body>
</html>
