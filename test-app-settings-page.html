<!DOCTYPE html>
<html class="light" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Test Pengaturan Aplikasi - RSUD Sehat Sentosa</title>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;600;700;900&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                    },
                    fontFamily: {
                        "display": ["Public Sans", "sans-serif"],
                        "sans": ["Public Sans", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem", 
                        "lg": "0.5rem", 
                        "xl": "0.75rem", 
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-white font-display transition-colors duration-200">
    <div class="relative flex h-screen w-full overflow-hidden">
        <!-- Side Navigation -->
        <aside class="flex w-72 flex-col border-r border-slate-200 bg-white dark:border-slate-800 dark:bg-[#111a22] transition-colors duration-200 flex-shrink-0">
            <div class="flex h-full flex-col justify-between p-4">
                <div class="flex flex-col gap-4">
                    <!-- User Profile / App Header in Sidebar -->
                    <div class="flex gap-3 items-center px-2 py-2">
                        <div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10 border border-slate-200 dark:border-slate-700" data-alt="Abstract medical cross logo with blue gradient" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCf_-Xr211EGVjCIhEGzSYTakMCAyD6oIECe0hLLqCQJ_KBnFlQyOT6n3LelD3IDeWAMVFMXKatrqhkJFKZY2raADMz9Hw306elO2jRru1GhLQQjBW_0yW59as_2DS6DBnEMPQl8CeJtuCycCPWdVCrhIvJQ0HI4-KNvzsVXyV4o-5caK_N_cfXe5gkRBdtE0mWv9uNszBzqf5DfUoYW3hvXF5LvB6QU9_v8Oa9iSlNkBYxJrttckeTSeehaNTdf_uwCehQ9dd1k5tl");'></div>
                        <div class="flex flex-col">
                            <h1 class="text-slate-900 dark:text-white text-base font-bold leading-normal">Admin Panel</h1>
                            <p class="text-slate-500 dark:text-slate-400 text-sm font-normal leading-normal">RSUD Sehat Sentosa</p>
                        </div>
                    </div>
                    
                    <!-- Navigation Links -->
                    <nav class="flex flex-col gap-2 mt-4">
                        <a class="flex items-center gap-3 px-3 py-2.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group" href="#">
                            <span class="material-symbols-outlined text-slate-500 group-hover:text-slate-900 dark:text-slate-400 dark:group-hover:text-white">grid_view</span>
                            <p class="text-slate-700 dark:text-slate-300 group-hover:text-slate-900 dark:group-hover:text-white text-sm font-medium leading-normal">Dashboard</p>
                        </a>
                        <a class="flex items-center gap-3 px-3 py-2.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group" href="#">
                            <span class="material-symbols-outlined text-slate-500 group-hover:text-slate-900 dark:text-slate-400 dark:group-hover:text-white">inbox</span>
                            <p class="text-slate-700 dark:text-slate-300 group-hover:text-slate-900 dark:group-hover:text-white text-sm font-medium leading-normal">Pengaduan Masuk</p>
                        </a>
                        <a class="flex items-center gap-3 px-3 py-2.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group" href="#">
                            <span class="material-symbols-outlined text-slate-500 group-hover:text-slate-900 dark:text-slate-400 dark:group-hover:text-white">auto_awesome</span>
                            <p class="text-slate-700 dark:text-slate-300 group-hover:text-slate-900 dark:group-hover:text-white text-sm font-medium leading-normal">Analisis AI</p>
                        </a>
                        <a class="flex items-center gap-3 px-3 py-2.5 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group" href="#">
                            <span class="material-symbols-outlined text-slate-500 group-hover:text-slate-900 dark:text-slate-400 dark:group-hover:text-white">description</span>
                            <p class="text-slate-700 dark:text-slate-300 group-hover:text-slate-900 dark:group-hover:text-white text-sm font-medium leading-normal">Laporan</p>
                        </a>
                        
                        <!-- Active State -->
                        <div class="flex items-center gap-3 px-3 py-2.5 rounded-lg bg-primary/10 dark:bg-primary/20">
                            <span class="material-symbols-outlined text-primary font-fill">settings</span>
                            <p class="text-primary text-sm font-bold leading-normal">Pengaturan</p>
                        </div>
                    </nav>
                </div>
                
                <!-- Bottom Links -->
                <div class="flex flex-col gap-2 border-t border-slate-200 dark:border-slate-800 pt-4">
                    <a class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 group transition-colors" href="#">
                        <span class="material-symbols-outlined text-red-500">logout</span>
                        <p class="text-red-500 text-sm font-medium leading-normal">Keluar</p>
                    </a>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 h-full overflow-y-auto bg-background-light dark:bg-background-dark">
            <div class="max-w-[1000px] mx-auto w-full px-6 py-8 md:px-10 md:py-10">
                <!-- Breadcrumbs -->
                <nav aria-label="Breadcrumb" class="flex mb-6">
                    <ol class="flex items-center gap-2">
                        <li>
                            <a class="text-slate-500 hover:text-primary dark:text-slate-400 dark:hover:text-primary transition-colors text-sm font-medium" href="#">Dashboard</a>
                        </li>
                        <li class="text-slate-400 dark:text-slate-600">/</li>
                        <li class="text-slate-500 hover:text-primary dark:text-slate-400 dark:hover:text-primary transition-colors text-sm font-medium">Pengaturan</li>
                        <li class="text-slate-400 dark:text-slate-600">/</li>
                        <li aria-current="page" class="text-slate-900 dark:text-white text-sm font-semibold">Aplikasi</li>
                    </ol>
                </nav>

                <!-- Page Header -->
                <div class="flex flex-col gap-2 mb-8">
                    <h1 class="text-3xl md:text-4xl font-bold tracking-tight text-slate-900 dark:text-white">Pengaturan Aplikasi</h1>
                    <p class="text-slate-500 dark:text-slate-400 text-base max-w-2xl">Kelola identitas aplikasi utama dan detail organisasi. Informasi ini akan digunakan oleh sistem AI untuk header laporan dan respons otomatis.</p>
                </div>

                <!-- Form Container -->
                <form class="flex flex-col gap-6" id="appSettingsForm">
                    <!-- Logo Upload Section -->
                    <div class="bg-white dark:bg-[#1e2936] rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden">
                        <div class="p-6">
                            <h2 class="text-lg font-bold text-slate-900 dark:text-white mb-1">Logo Instansi</h2>
                            <p class="text-sm text-slate-500 dark:text-slate-400 mb-6">Logo ini akan ditampilkan pada halaman login dan kop surat laporan.</p>
                            
                            <div class="flex flex-col sm:flex-row items-start sm:items-center gap-6">
                                <!-- Logo Preview -->
                                <div class="relative group shrink-0">
                                    <div class="w-32 h-32 rounded-lg border-2 border-dashed border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-800 flex items-center justify-center overflow-hidden relative" id="logoPreview">
                                        <div class="bg-contain bg-center bg-no-repeat w-full h-full p-2" data-alt="Current institution logo preview" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAIPfPjbYltqH_mTAVBlq5TBAyUxMT0Hm-P6yy0RHceBroIhncqoDRVdoZH_dJk-SOWg2-FxxKnp6ZZhYlb_GFzwwjeU4XME3R0bEVf5ueL7TRIGeo8F5GMdZSOfAyLppPewXBHpeS1j-ZhszqrOXF5axApjwYOWvOdotHxgV4AGdqEc_PFWyB8-3Br0QW796SfdYVyBuQaJr0HV4XpgZGuTJ9nIXR-WGBTVLxwDlU0R0hFX4WzqspqBGG5eb_bk9toxNBilomRS78A");'></div>
                                    </div>
                                </div>

                                <!-- Upload Controls -->
                                <div class="flex flex-col gap-3">
                                    <div class="flex gap-3">
                                        <label class="inline-flex items-center justify-center px-4 py-2 bg-white dark:bg-slate-700 border border-slate-300 dark:border-slate-600 rounded-lg text-sm font-medium text-slate-700 dark:text-slate-200 hover:bg-slate-50 dark:hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors cursor-pointer">
                                            <span class="material-symbols-outlined text-[20px] mr-2">upload</span>
                                            Unggah Logo Baru
                                            <input type="file" accept="image/*" class="hidden" id="logoInput">
                                        </label>
                                        <button class="inline-flex items-center justify-center px-4 py-2 bg-transparent border border-transparent rounded-lg text-sm font-medium text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 focus:outline-none transition-colors" type="button" id="removeLogo">Hapus</button>
                                    </div>
                                    <p class="text-xs text-slate-500 dark:text-slate-400">Format file yang didukung: JPG, PNG, atau SVG. Ukuran maksimal 2MB. Dimensi yang disarankan 512x512px.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- General Info Form -->
                    <div class="bg-white dark:bg-[#1e2936] rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm">
                        <div class="p-6 border-b border-slate-100 dark:border-slate-700/50">
                            <h2 class="text-lg font-bold text-slate-900 dark:text-white">Informasi Umum</h2>
                            <p class="text-sm text-slate-500 dark:text-slate-400 mt-1">Detail ini digunakan untuk identifikasi sistem.</p>
                        </div>
                        
                        <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Application Name -->
                            <div class="col-span-1 md:col-span-2">
                                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5" for="app_name">Nama Aplikasi</label>
                                <input class="block w-full rounded-lg border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm focus:border-primary focus:ring-primary sm:text-sm py-2.5 px-3" id="app_name" name="app_name" type="text" value="Sistem Pengaduan Masyarakat Terpadu"/>
                                <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">Nama yang muncul di tab browser dan judul dashboard.</p>
                            </div>

                            <!-- Institution Name -->
                            <div class="col-span-1 md:col-span-2">
                                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5" for="institution_name">Nama Instansi</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <span class="material-symbols-outlined text-slate-400 text-[20px]">apartment</span>
                                    </div>
                                    <input class="block w-full rounded-lg border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm focus:border-primary focus:ring-primary sm:text-sm pl-10 py-2.5 px-3" id="institution_name" name="institution_name" type="text" value="RSUD Sehat Sentosa"/>
                                </div>
                                <div class="mt-2 flex gap-2 items-start p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-xs text-blue-700 dark:text-blue-300">
                                    <span class="material-symbols-outlined text-[16px] shrink-0 mt-0.5">info</span>
                                    <span>Penting: Nama instansi digunakan oleh AI untuk men-generate surat tanggapan resmi secara otomatis.</span>
                                </div>
                            </div>

                            <!-- Manager Name -->
                            <div class="col-span-1">
                                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5" for="manager_name">Nama Pengelola Utama</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <span class="material-symbols-outlined text-slate-400 text-[20px]">person</span>
                                    </div>
                                    <input class="block w-full rounded-lg border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm focus:border-primary focus:ring-primary sm:text-sm pl-10 py-2.5 px-3" id="manager_name" name="manager_name" placeholder="Contoh: Dr. Budi Santoso" type="text"/>
                                </div>
                            </div>

                            <!-- Job Title -->
                            <div class="col-span-1">
                                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5" for="manager_position">Jabatan</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <span class="material-symbols-outlined text-slate-400 text-[20px]">badge</span>
                                    </div>
                                    <input class="block w-full rounded-lg border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm focus:border-primary focus:ring-primary sm:text-sm pl-10 py-2.5 px-3" id="manager_position" name="manager_position" placeholder="Contoh: Kepala Bagian Humas" type="text"/>
                                </div>
                            </div>

                            <!-- Description -->
                            <div class="col-span-1 md:col-span-2">
                                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5" for="description">Deskripsi Instansi</label>
                                <textarea class="block w-full rounded-lg border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm focus:border-primary focus:ring-primary sm:text-sm py-2.5 px-3" id="description" name="description" rows="3" placeholder="Deskripsi singkat tentang instansi..."></textarea>
                            </div>

                            <!-- Address -->
                            <div class="col-span-1 md:col-span-2">
                                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5" for="address">Alamat</label>
                                <textarea class="block w-full rounded-lg border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm focus:border-primary focus:ring-primary sm:text-sm py-2.5 px-3" id="address" name="address" rows="2" placeholder="Alamat lengkap instansi..."></textarea>
                            </div>

                            <!-- Contact Phone -->
                            <div class="col-span-1">
                                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5" for="contact_phone">Nomor Telepon</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <span class="material-symbols-outlined text-slate-400 text-[20px]">phone</span>
                                    </div>
                                    <input class="block w-full rounded-lg border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm focus:border-primary focus:ring-primary sm:text-sm pl-10 py-2.5 px-3" id="contact_phone" name="contact_phone" placeholder="Contoh: (021) 1234-5678" type="text"/>
                                </div>
                            </div>

                            <!-- Contact Email -->
                            <div class="col-span-1">
                                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5" for="contact_email">Email Kontak</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <span class="material-symbols-outlined text-slate-400 text-[20px]">email</span>
                                    </div>
                                    <input class="block w-full rounded-lg border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm focus:border-primary focus:ring-primary sm:text-sm pl-10 py-2.5 px-3" id="contact_email" name="contact_email" placeholder="Contoh: info@rsudsehatsentosa.go.id" type="email"/>
                                </div>
                            </div>

                            <!-- Website -->
                            <div class="col-span-1 md:col-span-2">
                                <label class="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1.5" for="website">Website Resmi</label>
                                <div class="relative">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <span class="material-symbols-outlined text-slate-400 text-[20px]">language</span>
                                    </div>
                                    <input class="block w-full rounded-lg border-slate-300 dark:border-slate-600 bg-white dark:bg-slate-800 text-slate-900 dark:text-white shadow-sm focus:border-primary focus:ring-primary sm:text-sm pl-10 py-2.5 px-3" id="website" name="website" placeholder="Contoh: https://www.rsudsehatsentosa.go.id" type="url"/>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Actions Footer -->
                    <div class="flex items-center justify-end gap-3 pt-4">
                        <button class="px-5 py-2.5 text-sm font-medium text-slate-700 dark:text-slate-200 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500 transition-colors" type="button">Batal</button>
                        <button class="px-5 py-2.5 text-sm font-bold text-white bg-primary rounded-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary shadow-sm hover:shadow transition-all flex items-center gap-2" type="submit" id="saveButton">
                            <span class="material-symbols-outlined text-[18px]">save</span>
                            Simpan Perubahan
                        </button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <script>
        // Mock data untuk testing
        const mockSettings = {
            app_name: 'Sistem Pengaduan Masyarakat Terpadu',
            institution_name: 'RSUD Sehat Sentosa',
            manager_name: 'Dr. Budi Santoso',
            manager_position: 'Kepala Bagian Humas',
            description: 'Rumah Sakit Umum Daerah yang melayani masyarakat dengan sepenuh hati',
            address: 'Jl. Kesehatan No. 123, Jakarta Selatan 12345',
            contact_phone: '(021) 1234-5678',
            contact_email: 'info@rsudsehatsentosa.go.id',
            website: 'https://www.rsudsehatsentosa.go.id',
            institution_logo: ''
        };

        // Load mock data
        function loadMockData() {
            Object.keys(mockSettings).forEach(key => {
                const element = document.getElementById(key);
                if (element && mockSettings[key]) {
                    element.value = mockSettings[key];
                }
            });
        }

        // Logo upload handler
        document.getElementById('logoInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                if (!file.type.startsWith('image/')) {
                    alert('File harus berupa gambar');
                    return;
                }
                
                if (file.size > 2 * 1024 * 1024) {
                    alert('Ukuran file maksimal 2MB');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('logoPreview');
                    preview.innerHTML = `<img src="${e.target.result}" alt="Logo preview" class="w-full h-full object-contain p-2">`;
                };
                reader.readAsDataURL(file);
            }
        });

        // Remove logo handler
        document.getElementById('removeLogo').addEventListener('click', function() {
            const preview = document.getElementById('logoPreview');
            preview.innerHTML = `
                <div class="text-slate-400 text-center">
                    <span class="material-symbols-outlined text-4xl mb-2 block">image</span>
                    <span class="text-xs">Belum ada logo</span>
                </div>
            `;
            document.getElementById('logoInput').value = '';
        });

        // Form submit handler
        document.getElementById('appSettingsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const saveButton = document.getElementById('saveButton');
            const originalContent = saveButton.innerHTML;
            
            // Show loading state
            saveButton.innerHTML = `
                <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
                Menyimpan...
            `;
            saveButton.disabled = true;

            // Simulate API call
            setTimeout(() => {
                alert('Pengaturan berhasil disimpan!');
                
                // Reset button
                saveButton.innerHTML = originalContent;
                saveButton.disabled = false;
            }, 2000);
        });

        // Load data on page load
        document.addEventListener('DOMContentLoaded', loadMockData);

        // Test API connection
        async function testApiConnection() {
            try {
                const response = await fetch('/api/app-settings/public');
                if (response.ok) {
                    const data = await response.json();
                    console.log('API Connection successful:', data);
                } else {
                    console.log('API Connection failed:', response.status);
                }
            } catch (error) {
                console.log('API Connection error:', error);
            }
        }

        // Test API on load
        testApiConnection();
    </script>
</body>
</html>