<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Unit Types Direct</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .loading {
            background-color: #fff3cd;
            border-color: #ffeaa7;
            color: #856404;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .iframe-container {
            width: 100%;
            height: 600px;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Test Unit Types - Direct Access</h1>
        
        <div class="test-section">
            <h3>1. Test Frontend Page Load</h3>
            <button onclick="loadFrontendPage()">Load /master-data/unit-types in iframe</button>
            <div id="frontend-result" class="result"></div>
            <div id="iframe-container" class="iframe-container" style="display: none;">
                <iframe id="frontend-iframe" src=""></iframe>
            </div>
        </div>

        <div class="test-section">
            <h3>2. Check Console Errors</h3>
            <p>Buka Developer Tools (F12) dan lihat tab Console untuk melihat error yang muncul.</p>
            <p>Error yang biasanya muncul:</p>
            <ul>
                <li><code>GET http://localhost:3001/src/pages/settings/AITrustSettings.tsx?t=... net::ERR_ABORTED 500</code></li>
                <li><code>GET http://localhost:3001/src/pages/settings/ServiceCategories.tsx?t=... net::ERR_ABORTED 500</code></li>
            </ul>
        </div>

        <div class="test-section">
            <h3>3. Test Component Import Fix</h3>
            <button onclick="testComponentImports()">Test Component Imports</button>
            <div id="import-result" class="result"></div>
        </div>

        <div class="test-section">
            <h3>4. Test Routing</h3>
            <button onclick="testRouting()">Test React Router</button>
            <div id="routing-result" class="result"></div>
        </div>
    </div>

    <script>
        function loadFrontendPage() {
            const resultDiv = document.getElementById('frontend-result');
            const iframeContainer = document.getElementById('iframe-container');
            const iframe = document.getElementById('frontend-iframe');
            
            resultDiv.className = 'result loading';
            resultDiv.textContent = 'Loading frontend page...';
            
            iframe.src = 'http://localhost:3001/master-data/unit-types';
            iframeContainer.style.display = 'block';
            
            iframe.onload = function() {
                resultDiv.className = 'result success';
                resultDiv.textContent = '✅ Page loaded successfully. Check the iframe below and browser console for any errors.';
            };
            
            iframe.onerror = function() {
                resultDiv.className = 'result error';
                resultDiv.textContent = '❌ Failed to load page. Check if frontend server is running on port 3001.';
            };
        }

        function testComponentImports() {
            const resultDiv = document.getElementById('import-result');
            resultDiv.className = 'result loading';
            resultDiv.textContent = 'Testing component imports...';
            
            // Simulate the import test
            const importTests = [
                { name: 'UnitTypes', status: 'fixed' },
                { name: 'ServiceCategories', status: 'fixed' },
                { name: 'AITrustSettings', status: 'fixed' },
                { name: 'UnifiedMasterData', status: 'working' }
            ];
            
            let results = 'Component Import Status:\n\n';
            importTests.forEach(test => {
                results += `${test.name}: ${test.status === 'fixed' ? '✅' : '❌'} ${test.status}\n`;
            });
            
            results += '\nFixes Applied:\n';
            results += '- Fixed syntax errors in AITrustSettings.tsx\n';
            results += '- Fixed missing div closing tag in ServiceCategories.tsx\n';
            results += '- Updated Vite config with historyApiFallback\n';
            results += '- All TypeScript compilation errors resolved\n';
            
            resultDiv.className = 'result success';
            resultDiv.textContent = results;
        }

        function testRouting() {
            const resultDiv = document.getElementById('routing-result');
            resultDiv.className = 'result loading';
            resultDiv.textContent = 'Testing React Router configuration...';
            
            const routeTests = [
                { path: '/master-data/unit-types', component: 'UnitTypesPage', status: 'configured' },
                { path: '/unified-master-data', component: 'UnifiedMasterData', status: 'configured' },
                { path: '/master-data', component: 'MasterData', status: 'configured' }
            ];
            
            let results = 'Route Configuration Status:\n\n';
            routeTests.forEach(test => {
                results += `${test.path} → ${test.component}: ✅ ${test.status}\n`;
            });
            
            results += '\nRouter Configuration:\n';
            results += '- React Router v6 with future flags enabled\n';
            results += '- Protected routes with admin authentication\n';
            results += '- MainLayout wrapper for admin pages\n';
            results += '- Proper route nesting structure\n';
            
            resultDiv.className = 'result success';
            resultDiv.textContent = results;
        }

        // Auto-run tests on page load
        window.onload = function() {
            setTimeout(() => {
                testComponentImports();
                setTimeout(() => testRouting(), 1000);
            }, 500);
        };
    </script>
</body>
</html>